function cov_ekdp46aoj(){var path="/Users/guilherme/Documents/Desenvolvimento/js-experts/aula05-tdd-project-pt03/test/unitTests/carService.test.js";var hash="de3237984e1eec0a69f137834e3421afa2cdd79d";var global=new Function("return this")();var gcv="__coverage__";var coverageData={path:"/Users/guilherme/Documents/Desenvolvimento/js-experts/aula05-tdd-project-pt03/test/unitTests/carService.test.js",statementMap:{"0":{start:{line:1,column:56},end:{line:1,column:72}},"1":{start:{line:2,column:19},end:{line:2,column:60}},"2":{start:{line:3,column:20},end:{line:3,column:63}},"3":{start:{line:4,column:17},end:{line:4,column:32}},"4":{start:{line:5,column:19},end:{line:5,column:34}},"5":{start:{line:6,column:14},end:{line:6,column:30}},"6":{start:{line:8,column:21},end:{line:8,column:69}},"7":{start:{line:10,column:14},end:{line:14,column:1}},"8":{start:{line:16,column:0},end:{line:139,column:2}},"9":{start:{line:17,column:19},end:{line:17,column:21}},"10":{start:{line:18,column:16},end:{line:18,column:18}},"11":{start:{line:20,column:2},end:{line:24,column:4}},"12":{start:{line:21,column:4},end:{line:23,column:6}},"13":{start:{line:25,column:2},end:{line:27,column:4}},"14":{start:{line:26,column:4},end:{line:26,column:35}},"15":{start:{line:28,column:2},end:{line:30,column:4}},"16":{start:{line:29,column:4},end:{line:29,column:21}},"17":{start:{line:32,column:2},end:{line:37,column:4}},"18":{start:{line:33,column:17},end:{line:33,column:29}},"19":{start:{line:34,column:19},end:{line:34,column:62}},"20":{start:{line:36,column:4},end:{line:36,column:55}},"21":{start:{line:39,column:2},end:{line:53,column:4}},"22":{start:{line:40,column:24},end:{line:40,column:46}},"23":{start:{line:41,column:23},end:{line:41,column:24}},"24":{start:{line:43,column:4},end:{line:46,column:25}},"25":{start:{line:48,column:19},end:{line:48,column:58}},"26":{start:{line:49,column:21},end:{line:49,column:51}},"27":{start:{line:51,column:4},end:{line:51,column:69}},"28":{start:{line:52,column:4},end:{line:52,column:40}},"29":{start:{line:55,column:2},end:{line:76,column:4}},"30":{start:{line:56,column:16},end:{line:56,column:30}},"31":{start:{line:57,column:24},end:{line:57,column:61}},"32":{start:{line:58,column:4},end:{line:58,column:33}},"33":{start:{line:60,column:4},end:{line:63,column:19}},"34":{start:{line:65,column:4},end:{line:68,column:5}},"35":{start:{line:70,column:19},end:{line:70,column:64}},"36":{start:{line:71,column:21},end:{line:71,column:24}},"37":{start:{line:73,column:4},end:{line:73,column:58}},"38":{start:{line:74,column:4},end:{line:74,column:76}},"39":{start:{line:75,column:4},end:{line:75,column:45}},"40":{start:{line:78,column:2},end:{line:101,column:4}},"41":{start:{line:79,column:21},end:{line:79,column:55}},"42":{start:{line:80,column:4},end:{line:80,column:21}},"43":{start:{line:82,column:24},end:{line:82,column:61}},"44":{start:{line:83,column:4},end:{line:83,column:28}},"45":{start:{line:85,column:25},end:{line:85,column:26}},"46":{start:{line:88,column:4},end:{line:91,column:50}},"47":{start:{line:91,column:16},end:{line:91,column:49}},"48":{start:{line:93,column:21},end:{line:93,column:61}},"49":{start:{line:94,column:19},end:{line:98,column:5}},"50":{start:{line:100,column:4},end:{line:100,column:40}},"51":{start:{line:103,column:2},end:{line:138,column:4}},"52":{start:{line:104,column:16},end:{line:104,column:30}},"53":{start:{line:105,column:24},end:{line:109,column:5}},"54":{start:{line:111,column:21},end:{line:111,column:55}},"55":{start:{line:112,column:4},end:{line:112,column:21}},"56":{start:{line:114,column:25},end:{line:114,column:26}},"57":{start:{line:115,column:20},end:{line:115,column:44}},"58":{start:{line:117,column:16},end:{line:117,column:37}},"59":{start:{line:118,column:4},end:{line:118,column:40}},"60":{start:{line:121,column:4},end:{line:124,column:19}},"61":{start:{line:126,column:27},end:{line:126,column:67}},"62":{start:{line:127,column:19},end:{line:129,column:5}},"63":{start:{line:130,column:21},end:{line:135,column:6}},"64":{start:{line:137,column:4},end:{line:137,column:45}}},fnMap:{"0":{name:"(anonymous_0)",decl:{start:{line:16,column:34},end:{line:16,column:35}},loc:{start:{line:16,column:40},end:{line:139,column:1}},line:16},"1":{name:"(anonymous_1)",decl:{start:{line:20,column:9},end:{line:20,column:10}},loc:{start:{line:20,column:15},end:{line:24,column:3}},line:20},"2":{name:"(anonymous_2)",decl:{start:{line:25,column:13},end:{line:25,column:14}},loc:{start:{line:25,column:19},end:{line:27,column:3}},line:25},"3":{name:"(anonymous_3)",decl:{start:{line:28,column:12},end:{line:28,column:13}},loc:{start:{line:28,column:18},end:{line:30,column:3}},line:28},"4":{name:"(anonymous_4)",decl:{start:{line:32,column:56},end:{line:32,column:57}},loc:{start:{line:32,column:62},end:{line:37,column:3}},line:32},"5":{name:"(anonymous_5)",decl:{start:{line:39,column:61},end:{line:39,column:62}},loc:{start:{line:39,column:67},end:{line:53,column:3}},line:39},"6":{name:"(anonymous_6)",decl:{start:{line:55,column:62},end:{line:55,column:63}},loc:{start:{line:55,column:74},end:{line:76,column:3}},line:55},"7":{name:"(anonymous_7)",decl:{start:{line:78,column:96},end:{line:78,column:97}},loc:{start:{line:78,column:102},end:{line:101,column:3}},line:78},"8":{name:"(anonymous_8)",decl:{start:{line:91,column:10},end:{line:91,column:11}},loc:{start:{line:91,column:16},end:{line:91,column:49}},line:91},"9":{name:"(anonymous_9)",decl:{start:{line:103,column:83},end:{line:103,column:84}},loc:{start:{line:103,column:95},end:{line:138,column:3}},line:103}},branchMap:{},s:{"0":0,"1":0,"2":0,"3":0,"4":0,"5":0,"6":0,"7":0,"8":0,"9":0,"10":0,"11":0,"12":0,"13":0,"14":0,"15":0,"16":0,"17":0,"18":0,"19":0,"20":0,"21":0,"22":0,"23":0,"24":0,"25":0,"26":0,"27":0,"28":0,"29":0,"30":0,"31":0,"32":0,"33":0,"34":0,"35":0,"36":0,"37":0,"38":0,"39":0,"40":0,"41":0,"42":0,"43":0,"44":0,"45":0,"46":0,"47":0,"48":0,"49":0,"50":0,"51":0,"52":0,"53":0,"54":0,"55":0,"56":0,"57":0,"58":0,"59":0,"60":0,"61":0,"62":0,"63":0,"64":0},f:{"0":0,"1":0,"2":0,"3":0,"4":0,"5":0,"6":0,"7":0,"8":0,"9":0},b:{},_coverageSchema:"1a1c01bbd47fc00a2c39e90264f33305004495a9",hash:"de3237984e1eec0a69f137834e3421afa2cdd79d"};var coverage=global[gcv]||(global[gcv]={});if(!coverage[path]||coverage[path].hash!==hash){coverage[path]=coverageData;}var actualCoverage=coverage[path];{// @ts-ignore
cov_ekdp46aoj=function(){return actualCoverage;};}return actualCoverage;}cov_ekdp46aoj();const{describe,it,before,beforeEach,afterEach}=(cov_ekdp46aoj().s[0]++,require('mocha'));const CarService=(cov_ekdp46aoj().s[1]++,require('./../../src/service/carService'));const Transaction=(cov_ekdp46aoj().s[2]++,require('./../../src/entities/transaction'));const{join}=(cov_ekdp46aoj().s[3]++,require('path'));const{expect}=(cov_ekdp46aoj().s[4]++,require('chai'));const sinon=(cov_ekdp46aoj().s[5]++,require('sinon'));const carsDatabase=(cov_ekdp46aoj().s[6]++,join(__dirname,'./../../database',"cars.json"));const mocks=(cov_ekdp46aoj().s[7]++,{validCarCategory:require('./../mocks/valid-carCategory.json'),validCar:require('./../mocks/valid-car.json'),validCustomer:require('./../mocks/valid-customer.json')});cov_ekdp46aoj().s[8]++;describe('CarService Suite Test',()=>{cov_ekdp46aoj().f[0]++;let carService=(cov_ekdp46aoj().s[9]++,{});let sandbox=(cov_ekdp46aoj().s[10]++,{});cov_ekdp46aoj().s[11]++;before(()=>{cov_ekdp46aoj().f[1]++;cov_ekdp46aoj().s[12]++;carService=new CarService({cars:carsDatabase});});cov_ekdp46aoj().s[13]++;beforeEach(()=>{cov_ekdp46aoj().f[2]++;cov_ekdp46aoj().s[14]++;sandbox=sinon.createSandbox();});cov_ekdp46aoj().s[15]++;afterEach(()=>{cov_ekdp46aoj().f[3]++;cov_ekdp46aoj().s[16]++;sandbox.restore();});cov_ekdp46aoj().s[17]++;it('should retrive a randoom position from an array',()=>{cov_ekdp46aoj().f[4]++;const data=(cov_ekdp46aoj().s[18]++,[0,1,2,4]);const result=(cov_ekdp46aoj().s[19]++,carService.getRandomPositionFromArray(data));cov_ekdp46aoj().s[20]++;expect(result).to.be.lte(data.length).and.be.gte(0);});cov_ekdp46aoj().s[21]++;it('shold choose the first id from carIds in carCategory',()=>{cov_ekdp46aoj().f[5]++;const carCategory=(cov_ekdp46aoj().s[22]++,mocks.validCarCategory);const carIdIndex=(cov_ekdp46aoj().s[23]++,0);cov_ekdp46aoj().s[24]++;sandbox.stub(carService,carService.getRandomPositionFromArray.name).returns(carIdIndex);const result=(cov_ekdp46aoj().s[25]++,carService.chooseRandomCar(carCategory));const expected=(cov_ekdp46aoj().s[26]++,carCategory.carIds[carIdIndex]);cov_ekdp46aoj().s[27]++;expect(carService.getRandomPositionFromArray.calledOnce).to.be.ok;cov_ekdp46aoj().s[28]++;expect(result).to.be.equal(expected);});cov_ekdp46aoj().s[29]++;it('given a carCategory it should return an available car',async()=>{cov_ekdp46aoj().f[6]++;const car=(cov_ekdp46aoj().s[30]++,mocks.validCar);const carCategory=(cov_ekdp46aoj().s[31]++,Object.create(mocks.validCarCategory));cov_ekdp46aoj().s[32]++;carCategory.carIds=[car.id];cov_ekdp46aoj().s[33]++;sandbox.stub(carService.carRepository,carService.carRepository.find.name).resolves(car);cov_ekdp46aoj().s[34]++;sandbox.spy(carService,carService.chooseRandomCar.name);const result=(cov_ekdp46aoj().s[35]++,await carService.getAvailableCar(carCategory));const expected=(cov_ekdp46aoj().s[36]++,car);cov_ekdp46aoj().s[37]++;expect(carService.chooseRandomCar.calledOnce).to.be.ok;cov_ekdp46aoj().s[38]++;expect(carService.carRepository.find.calledWithExactly(car.id)).to.be.ok;cov_ekdp46aoj().s[39]++;expect(result).to.be.deep.equal(expected);});cov_ekdp46aoj().s[40]++;it('given a carCategory, customer and numberOfDays it should calculate final amount in real',()=>{cov_ekdp46aoj().f[7]++;const customer=(cov_ekdp46aoj().s[41]++,Object.create(mocks.validCustomer));cov_ekdp46aoj().s[42]++;customer.age=50;const carCategory=(cov_ekdp46aoj().s[43]++,Object.create(mocks.validCarCategory));cov_ekdp46aoj().s[44]++;carCategory.price=37.6;const numberOfDays=(cov_ekdp46aoj().s[45]++,5);// nao depender de dados externos!
cov_ekdp46aoj().s[46]++;sandbox.stub(carService,"taxesBasedOnAge").get(()=>{cov_ekdp46aoj().f[8]++;cov_ekdp46aoj().s[47]++;return[{from:40,to:50,then:1.3}];});const expected=(cov_ekdp46aoj().s[48]++,carService.currencyFormat.format(244.40));const result=(cov_ekdp46aoj().s[49]++,carService.calculateFinalPrice(customer,carCategory,numberOfDays));cov_ekdp46aoj().s[50]++;expect(result).to.be.equal(expected);});cov_ekdp46aoj().s[51]++;it('given a customer and a car category it should return a transaction receipt',async()=>{cov_ekdp46aoj().f[9]++;const car=(cov_ekdp46aoj().s[52]++,mocks.validCar);const carCategory=(cov_ekdp46aoj().s[53]++,{...mocks.validCarCategory,price:37.6,carIds:[car.id]});const customer=(cov_ekdp46aoj().s[54]++,Object.create(mocks.validCustomer));cov_ekdp46aoj().s[55]++;customer.age=20;const numberOfDays=(cov_ekdp46aoj().s[56]++,5);const dueDate=(cov_ekdp46aoj().s[57]++,"10 de novembro de 2020");const now=(cov_ekdp46aoj().s[58]++,new Date(2020,10,5));cov_ekdp46aoj().s[59]++;sandbox.useFakeTimers(now.getTime());// age: 20, tax: 1.1, categoryPrice: 37.6
// 37.6 * 1.1 = 41.36 * 5 days = 206.8
cov_ekdp46aoj().s[60]++;sandbox.stub(carService.carRepository,carService.carRepository.find.name).resolves(car);const expectedAmount=(cov_ekdp46aoj().s[61]++,carService.currencyFormat.format(206.80));const result=(cov_ekdp46aoj().s[62]++,await carService.rent(customer,carCategory,numberOfDays));const expected=(cov_ekdp46aoj().s[63]++,new Transaction({customer,car,dueDate,amount:expectedAmount}));cov_ekdp46aoj().s[64]++;expect(result).to.be.deep.equal(expected);});});
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImNhclNlcnZpY2UudGVzdC5qcyJdLCJuYW1lcyI6WyJkZXNjcmliZSIsIml0IiwiYmVmb3JlIiwiYmVmb3JlRWFjaCIsImFmdGVyRWFjaCIsInJlcXVpcmUiLCJDYXJTZXJ2aWNlIiwiVHJhbnNhY3Rpb24iLCJqb2luIiwiZXhwZWN0Iiwic2lub24iLCJjYXJzRGF0YWJhc2UiLCJfX2Rpcm5hbWUiLCJtb2NrcyIsInZhbGlkQ2FyQ2F0ZWdvcnkiLCJ2YWxpZENhciIsInZhbGlkQ3VzdG9tZXIiLCJjYXJTZXJ2aWNlIiwic2FuZGJveCIsImNhcnMiLCJjcmVhdGVTYW5kYm94IiwicmVzdG9yZSIsImRhdGEiLCJyZXN1bHQiLCJnZXRSYW5kb21Qb3NpdGlvbkZyb21BcnJheSIsInRvIiwiYmUiLCJsdGUiLCJsZW5ndGgiLCJhbmQiLCJndGUiLCJjYXJDYXRlZ29yeSIsImNhcklkSW5kZXgiLCJzdHViIiwibmFtZSIsInJldHVybnMiLCJjaG9vc2VSYW5kb21DYXIiLCJleHBlY3RlZCIsImNhcklkcyIsImNhbGxlZE9uY2UiLCJvayIsImVxdWFsIiwiY2FyIiwiT2JqZWN0IiwiY3JlYXRlIiwiaWQiLCJjYXJSZXBvc2l0b3J5IiwiZmluZCIsInJlc29sdmVzIiwic3B5IiwiZ2V0QXZhaWxhYmxlQ2FyIiwiY2FsbGVkV2l0aEV4YWN0bHkiLCJkZWVwIiwiY3VzdG9tZXIiLCJhZ2UiLCJwcmljZSIsIm51bWJlck9mRGF5cyIsImdldCIsImZyb20iLCJ0aGVuIiwiY3VycmVuY3lGb3JtYXQiLCJmb3JtYXQiLCJjYWxjdWxhdGVGaW5hbFByaWNlIiwiZHVlRGF0ZSIsIm5vdyIsIkRhdGUiLCJ1c2VGYWtlVGltZXJzIiwiZ2V0VGltZSIsImV4cGVjdGVkQW1vdW50IiwicmVudCIsImFtb3VudCJdLCJtYXBwaW5ncyI6IjJ0TUFlWTt5RkFmWixLQUFNLENBQUVBLFFBQUYsQ0FBWUMsRUFBWixDQUFnQkMsTUFBaEIsQ0FBd0JDLFVBQXhCLENBQW9DQyxTQUFwQywwQkFBa0RDLE9BQU8sQ0FBQyxPQUFELENBQXpELENBQU4sQ0FDQSxLQUFNQyxDQUFBQSxVQUFVLHlCQUFHRCxPQUFPLENBQUMsZ0NBQUQsQ0FBVixDQUFoQixDQUNBLEtBQU1FLENBQUFBLFdBQVcseUJBQUdGLE9BQU8sQ0FBQyxrQ0FBRCxDQUFWLENBQWpCLENBQ0EsS0FBTSxDQUFFRyxJQUFGLDBCQUFXSCxPQUFPLENBQUMsTUFBRCxDQUFsQixDQUFOLENBQ0EsS0FBTSxDQUFFSSxNQUFGLDBCQUFhSixPQUFPLENBQUMsTUFBRCxDQUFwQixDQUFOLENBQ0EsS0FBTUssQ0FBQUEsS0FBSyx5QkFBR0wsT0FBTyxDQUFDLE9BQUQsQ0FBVixDQUFYLENBRUEsS0FBTU0sQ0FBQUEsWUFBWSx5QkFBR0gsSUFBSSxDQUFDSSxTQUFELENBQVksa0JBQVosQ0FBZ0MsV0FBaEMsQ0FBUCxDQUFsQixDQUVBLEtBQU1DLENBQUFBLEtBQUsseUJBQUcsQ0FDWkMsZ0JBQWdCLENBQUVULE9BQU8sQ0FBQyxtQ0FBRCxDQURiLENBRVpVLFFBQVEsQ0FBRVYsT0FBTyxDQUFDLDJCQUFELENBRkwsQ0FHWlcsYUFBYSxDQUFFWCxPQUFPLENBQUMsZ0NBQUQsQ0FIVixDQUFILENBQVgsQyx1QkFNQUwsUUFBUSxDQUFDLHVCQUFELENBQTBCLElBQU0sd0JBQ3RDLEdBQUlpQixDQUFBQSxVQUFVLHlCQUFHLEVBQUgsQ0FBZCxDQUNBLEdBQUlDLENBQUFBLE9BQU8sMEJBQUcsRUFBSCxDQUFYLENBRnNDLHdCQUl0Q2hCLE1BQU0sQ0FBQyxJQUFNLGdEQUNYZSxVQUFVLENBQUcsR0FBSVgsQ0FBQUEsVUFBSixDQUFlLENBQzFCYSxJQUFJLENBQUVSLFlBRG9CLENBQWYsQ0FBYixDQUdELENBSkssQ0FBTixDQUpzQyx3QkFTdENSLFVBQVUsQ0FBQyxJQUFNLGdEQUNmZSxPQUFPLENBQUdSLEtBQUssQ0FBQ1UsYUFBTixFQUFWLENBQ0QsQ0FGUyxDQUFWLENBVHNDLHdCQVl0Q2hCLFNBQVMsQ0FBQyxJQUFNLGdEQUNkYyxPQUFPLENBQUNHLE9BQVIsR0FDRCxDQUZRLENBQVQsQ0Fac0Msd0JBZ0J0Q3BCLEVBQUUsQ0FBQyxpREFBRCxDQUFvRCxJQUFNLHdCQUMxRCxLQUFNcUIsQ0FBQUEsSUFBSSwwQkFBRyxDQUFDLENBQUQsQ0FBSSxDQUFKLENBQU8sQ0FBUCxDQUFVLENBQVYsQ0FBSCxDQUFWLENBQ0EsS0FBTUMsQ0FBQUEsTUFBTSwwQkFBR04sVUFBVSxDQUFDTywwQkFBWCxDQUFzQ0YsSUFBdEMsQ0FBSCxDQUFaLENBRjBELHdCQUkxRGIsTUFBTSxDQUFDYyxNQUFELENBQU4sQ0FBZUUsRUFBZixDQUFrQkMsRUFBbEIsQ0FBcUJDLEdBQXJCLENBQXlCTCxJQUFJLENBQUNNLE1BQTlCLEVBQXNDQyxHQUF0QyxDQUEwQ0gsRUFBMUMsQ0FBNkNJLEdBQTdDLENBQWlELENBQWpELEVBQ0QsQ0FMQyxDQUFGLENBaEJzQyx3QkF1QnRDN0IsRUFBRSxDQUFDLHNEQUFELENBQXlELElBQU0sd0JBQy9ELEtBQU04QixDQUFBQSxXQUFXLDBCQUFHbEIsS0FBSyxDQUFDQyxnQkFBVCxDQUFqQixDQUNBLEtBQU1rQixDQUFBQSxVQUFVLDBCQUFHLENBQUgsQ0FBaEIsQ0FGK0Qsd0JBSS9EZCxPQUFPLENBQUNlLElBQVIsQ0FDRWhCLFVBREYsQ0FFRUEsVUFBVSxDQUFDTywwQkFBWCxDQUFzQ1UsSUFGeEMsRUFHRUMsT0FIRixDQUdVSCxVQUhWLEVBS0EsS0FBTVQsQ0FBQUEsTUFBTSwwQkFBR04sVUFBVSxDQUFDbUIsZUFBWCxDQUEyQkwsV0FBM0IsQ0FBSCxDQUFaLENBQ0EsS0FBTU0sQ0FBQUEsUUFBUSwwQkFBR04sV0FBVyxDQUFDTyxNQUFaLENBQW1CTixVQUFuQixDQUFILENBQWQsQ0FWK0Qsd0JBWS9EdkIsTUFBTSxDQUFDUSxVQUFVLENBQUNPLDBCQUFYLENBQXNDZSxVQUF2QyxDQUFOLENBQXlEZCxFQUF6RCxDQUE0REMsRUFBNUQsQ0FBK0RjLEVBQS9ELENBWitELHdCQWEvRC9CLE1BQU0sQ0FBQ2MsTUFBRCxDQUFOLENBQWVFLEVBQWYsQ0FBa0JDLEVBQWxCLENBQXFCZSxLQUFyQixDQUEyQkosUUFBM0IsRUFDRCxDQWRDLENBQUYsQ0F2QnNDLHdCQXVDdENwQyxFQUFFLENBQUMsdURBQUQsQ0FBMEQsU0FBWSx3QkFDdEUsS0FBTXlDLENBQUFBLEdBQUcsMEJBQUc3QixLQUFLLENBQUNFLFFBQVQsQ0FBVCxDQUNBLEtBQU1nQixDQUFBQSxXQUFXLDBCQUFHWSxNQUFNLENBQUNDLE1BQVAsQ0FBYy9CLEtBQUssQ0FBQ0MsZ0JBQXBCLENBQUgsQ0FBakIsQ0FGc0Usd0JBR3RFaUIsV0FBVyxDQUFDTyxNQUFaLENBQXFCLENBQUNJLEdBQUcsQ0FBQ0csRUFBTCxDQUFyQixDQUhzRSx3QkFLdEUzQixPQUFPLENBQUNlLElBQVIsQ0FDRWhCLFVBQVUsQ0FBQzZCLGFBRGIsQ0FFRTdCLFVBQVUsQ0FBQzZCLGFBQVgsQ0FBeUJDLElBQXpCLENBQThCYixJQUZoQyxFQUdFYyxRQUhGLENBR1dOLEdBSFgsRUFMc0Usd0JBVXRFeEIsT0FBTyxDQUFDK0IsR0FBUixDQUNFaEMsVUFERixDQUVFQSxVQUFVLENBQUNtQixlQUFYLENBQTJCRixJQUY3QixFQUtBLEtBQU1YLENBQUFBLE1BQU0sMEJBQUcsS0FBTU4sQ0FBQUEsVUFBVSxDQUFDaUMsZUFBWCxDQUEyQm5CLFdBQTNCLENBQVQsQ0FBWixDQUNBLEtBQU1NLENBQUFBLFFBQVEsMEJBQUdLLEdBQUgsQ0FBZCxDQWhCc0Usd0JBa0J0RWpDLE1BQU0sQ0FBQ1EsVUFBVSxDQUFDbUIsZUFBWCxDQUEyQkcsVUFBNUIsQ0FBTixDQUE4Q2QsRUFBOUMsQ0FBaURDLEVBQWpELENBQW9EYyxFQUFwRCxDQWxCc0Usd0JBbUJ0RS9CLE1BQU0sQ0FBQ1EsVUFBVSxDQUFDNkIsYUFBWCxDQUF5QkMsSUFBekIsQ0FBOEJJLGlCQUE5QixDQUFnRFQsR0FBRyxDQUFDRyxFQUFwRCxDQUFELENBQU4sQ0FBZ0VwQixFQUFoRSxDQUFtRUMsRUFBbkUsQ0FBc0VjLEVBQXRFLENBbkJzRSx3QkFvQnRFL0IsTUFBTSxDQUFDYyxNQUFELENBQU4sQ0FBZUUsRUFBZixDQUFrQkMsRUFBbEIsQ0FBcUIwQixJQUFyQixDQUEwQlgsS0FBMUIsQ0FBZ0NKLFFBQWhDLEVBQ0QsQ0FyQkMsQ0FBRixDQXZDc0Msd0JBOER0Q3BDLEVBQUUsQ0FBQyx5RkFBRCxDQUE0RixJQUFNLHdCQUNsRyxLQUFNb0QsQ0FBQUEsUUFBUSwwQkFBR1YsTUFBTSxDQUFDQyxNQUFQLENBQWMvQixLQUFLLENBQUNHLGFBQXBCLENBQUgsQ0FBZCxDQURrRyx3QkFFbEdxQyxRQUFRLENBQUNDLEdBQVQsQ0FBZSxFQUFmLENBRUEsS0FBTXZCLENBQUFBLFdBQVcsMEJBQUdZLE1BQU0sQ0FBQ0MsTUFBUCxDQUFjL0IsS0FBSyxDQUFDQyxnQkFBcEIsQ0FBSCxDQUFqQixDQUprRyx3QkFLbEdpQixXQUFXLENBQUN3QixLQUFaLENBQW9CLElBQXBCLENBRUEsS0FBTUMsQ0FBQUEsWUFBWSwwQkFBRyxDQUFILENBQWxCLENBRUE7QUFUa0csd0JBVWxHdEMsT0FBTyxDQUFDZSxJQUFSLENBQ0VoQixVQURGLENBRUUsaUJBRkYsRUFHRXdDLEdBSEYsQ0FHTSxJQUFNLHVEQUFDLENBQUVDLElBQUksQ0FBRSxFQUFSLENBQVlqQyxFQUFFLENBQUUsRUFBaEIsQ0FBb0JrQyxJQUFJLENBQUUsR0FBMUIsQ0FBRCxFQUFpQyxDQUg3QyxFQUtBLEtBQU10QixDQUFBQSxRQUFRLDBCQUFHcEIsVUFBVSxDQUFDMkMsY0FBWCxDQUEwQkMsTUFBMUIsQ0FBaUMsTUFBakMsQ0FBSCxDQUFkLENBQ0EsS0FBTXRDLENBQUFBLE1BQU0sMEJBQUdOLFVBQVUsQ0FBQzZDLG1CQUFYLENBQ2JULFFBRGEsQ0FFYnRCLFdBRmEsQ0FHYnlCLFlBSGEsQ0FBSCxDQUFaLENBaEJrRyx3QkFzQmxHL0MsTUFBTSxDQUFDYyxNQUFELENBQU4sQ0FBZUUsRUFBZixDQUFrQkMsRUFBbEIsQ0FBcUJlLEtBQXJCLENBQTJCSixRQUEzQixFQUNELENBdkJDLENBQUYsQ0E5RHNDLHdCQXVGdENwQyxFQUFFLENBQUMsNEVBQUQsQ0FBK0UsU0FBWSx3QkFDM0YsS0FBTXlDLENBQUFBLEdBQUcsMEJBQUc3QixLQUFLLENBQUNFLFFBQVQsQ0FBVCxDQUNBLEtBQU1nQixDQUFBQSxXQUFXLDBCQUFHLENBQ2xCLEdBQUdsQixLQUFLLENBQUNDLGdCQURTLENBRWxCeUMsS0FBSyxDQUFFLElBRlcsQ0FHbEJqQixNQUFNLENBQUUsQ0FBQ0ksR0FBRyxDQUFDRyxFQUFMLENBSFUsQ0FBSCxDQUFqQixDQU1BLEtBQU1RLENBQUFBLFFBQVEsMEJBQUdWLE1BQU0sQ0FBQ0MsTUFBUCxDQUFjL0IsS0FBSyxDQUFDRyxhQUFwQixDQUFILENBQWQsQ0FSMkYsd0JBUzNGcUMsUUFBUSxDQUFDQyxHQUFULENBQWUsRUFBZixDQUVBLEtBQU1FLENBQUFBLFlBQVksMEJBQUcsQ0FBSCxDQUFsQixDQUNBLEtBQU1PLENBQUFBLE9BQU8sMEJBQUcsd0JBQUgsQ0FBYixDQUVBLEtBQU1DLENBQUFBLEdBQUcsMEJBQUcsR0FBSUMsQ0FBQUEsSUFBSixDQUFTLElBQVQsQ0FBZSxFQUFmLENBQW1CLENBQW5CLENBQUgsQ0FBVCxDQWQyRix3QkFlM0YvQyxPQUFPLENBQUNnRCxhQUFSLENBQXNCRixHQUFHLENBQUNHLE9BQUosRUFBdEIsRUFDQTtBQUNBO0FBakIyRix3QkFrQjNGakQsT0FBTyxDQUFDZSxJQUFSLENBQ0VoQixVQUFVLENBQUM2QixhQURiLENBRUU3QixVQUFVLENBQUM2QixhQUFYLENBQXlCQyxJQUF6QixDQUE4QmIsSUFGaEMsRUFHRWMsUUFIRixDQUdXTixHQUhYLEVBS0EsS0FBTTBCLENBQUFBLGNBQWMsMEJBQUduRCxVQUFVLENBQUMyQyxjQUFYLENBQTBCQyxNQUExQixDQUFpQyxNQUFqQyxDQUFILENBQXBCLENBQ0EsS0FBTXRDLENBQUFBLE1BQU0sMEJBQUcsS0FBTU4sQ0FBQUEsVUFBVSxDQUFDb0QsSUFBWCxDQUNuQmhCLFFBRG1CLENBQ1R0QixXQURTLENBQ0l5QixZQURKLENBQVQsQ0FBWixDQUdBLEtBQU1uQixDQUFBQSxRQUFRLDBCQUFHLEdBQUk5QixDQUFBQSxXQUFKLENBQWdCLENBQy9COEMsUUFEK0IsQ0FFL0JYLEdBRitCLENBRy9CcUIsT0FIK0IsQ0FJL0JPLE1BQU0sQ0FBRUYsY0FKdUIsQ0FBaEIsQ0FBSCxDQUFkLENBM0IyRix3QkFrQzNGM0QsTUFBTSxDQUFDYyxNQUFELENBQU4sQ0FBZUUsRUFBZixDQUFrQkMsRUFBbEIsQ0FBcUIwQixJQUFyQixDQUEwQlgsS0FBMUIsQ0FBZ0NKLFFBQWhDLEVBQ0QsQ0FuQ0MsQ0FBRixDQW9DRCxDQTNITyxDQUFSIiwic291cmNlc0NvbnRlbnQiOlsiY29uc3QgeyBkZXNjcmliZSwgaXQsIGJlZm9yZSwgYmVmb3JlRWFjaCwgYWZ0ZXJFYWNoIH0gPSByZXF1aXJlKCdtb2NoYScpXG5jb25zdCBDYXJTZXJ2aWNlID0gcmVxdWlyZSgnLi8uLi8uLi9zcmMvc2VydmljZS9jYXJTZXJ2aWNlJylcbmNvbnN0IFRyYW5zYWN0aW9uID0gcmVxdWlyZSgnLi8uLi8uLi9zcmMvZW50aXRpZXMvdHJhbnNhY3Rpb24nKVxuY29uc3QgeyBqb2luIH0gPSByZXF1aXJlKCdwYXRoJylcbmNvbnN0IHsgZXhwZWN0IH0gPSByZXF1aXJlKCdjaGFpJylcbmNvbnN0IHNpbm9uID0gcmVxdWlyZSgnc2lub24nKVxuXG5jb25zdCBjYXJzRGF0YWJhc2UgPSBqb2luKF9fZGlybmFtZSwgJy4vLi4vLi4vZGF0YWJhc2UnLCBcImNhcnMuanNvblwiKVxuXG5jb25zdCBtb2NrcyA9IHtcbiAgdmFsaWRDYXJDYXRlZ29yeTogcmVxdWlyZSgnLi8uLi9tb2Nrcy92YWxpZC1jYXJDYXRlZ29yeS5qc29uJyksXG4gIHZhbGlkQ2FyOiByZXF1aXJlKCcuLy4uL21vY2tzL3ZhbGlkLWNhci5qc29uJyksXG4gIHZhbGlkQ3VzdG9tZXI6IHJlcXVpcmUoJy4vLi4vbW9ja3MvdmFsaWQtY3VzdG9tZXIuanNvbicpXG59XG5cbmRlc2NyaWJlKCdDYXJTZXJ2aWNlIFN1aXRlIFRlc3QnLCAoKSA9PiB7XG4gIGxldCBjYXJTZXJ2aWNlID0ge31cbiAgbGV0IHNhbmRib3ggPSB7fVxuXG4gIGJlZm9yZSgoKSA9PiB7XG4gICAgY2FyU2VydmljZSA9IG5ldyBDYXJTZXJ2aWNlKHtcbiAgICAgIGNhcnM6IGNhcnNEYXRhYmFzZVxuICAgIH0pXG4gIH0pXG4gIGJlZm9yZUVhY2goKCkgPT4ge1xuICAgIHNhbmRib3ggPSBzaW5vbi5jcmVhdGVTYW5kYm94KClcbiAgfSlcbiAgYWZ0ZXJFYWNoKCgpID0+IHtcbiAgICBzYW5kYm94LnJlc3RvcmUoKVxuICB9KVxuXG4gIGl0KCdzaG91bGQgcmV0cml2ZSBhIHJhbmRvb20gcG9zaXRpb24gZnJvbSBhbiBhcnJheScsICgpID0+IHtcbiAgICBjb25zdCBkYXRhID0gWzAsIDEsIDIsIDRdXG4gICAgY29uc3QgcmVzdWx0ID0gY2FyU2VydmljZS5nZXRSYW5kb21Qb3NpdGlvbkZyb21BcnJheShkYXRhKVxuXG4gICAgZXhwZWN0KHJlc3VsdCkudG8uYmUubHRlKGRhdGEubGVuZ3RoKS5hbmQuYmUuZ3RlKDApXG4gIH0pXG5cbiAgaXQoJ3Nob2xkIGNob29zZSB0aGUgZmlyc3QgaWQgZnJvbSBjYXJJZHMgaW4gY2FyQ2F0ZWdvcnknLCAoKSA9PiB7XG4gICAgY29uc3QgY2FyQ2F0ZWdvcnkgPSBtb2Nrcy52YWxpZENhckNhdGVnb3J5XG4gICAgY29uc3QgY2FySWRJbmRleCA9IDBcblxuICAgIHNhbmRib3guc3R1YihcbiAgICAgIGNhclNlcnZpY2UsXG4gICAgICBjYXJTZXJ2aWNlLmdldFJhbmRvbVBvc2l0aW9uRnJvbUFycmF5Lm5hbWVcbiAgICApLnJldHVybnMoY2FySWRJbmRleClcblxuICAgIGNvbnN0IHJlc3VsdCA9IGNhclNlcnZpY2UuY2hvb3NlUmFuZG9tQ2FyKGNhckNhdGVnb3J5KVxuICAgIGNvbnN0IGV4cGVjdGVkID0gY2FyQ2F0ZWdvcnkuY2FySWRzW2NhcklkSW5kZXhdXG5cbiAgICBleHBlY3QoY2FyU2VydmljZS5nZXRSYW5kb21Qb3NpdGlvbkZyb21BcnJheS5jYWxsZWRPbmNlKS50by5iZS5va1xuICAgIGV4cGVjdChyZXN1bHQpLnRvLmJlLmVxdWFsKGV4cGVjdGVkKVxuICB9KVxuXG4gIGl0KCdnaXZlbiBhIGNhckNhdGVnb3J5IGl0IHNob3VsZCByZXR1cm4gYW4gYXZhaWxhYmxlIGNhcicsIGFzeW5jICgpID0+IHtcbiAgICBjb25zdCBjYXIgPSBtb2Nrcy52YWxpZENhclxuICAgIGNvbnN0IGNhckNhdGVnb3J5ID0gT2JqZWN0LmNyZWF0ZShtb2Nrcy52YWxpZENhckNhdGVnb3J5KVxuICAgIGNhckNhdGVnb3J5LmNhcklkcyA9IFtjYXIuaWRdXG5cbiAgICBzYW5kYm94LnN0dWIoXG4gICAgICBjYXJTZXJ2aWNlLmNhclJlcG9zaXRvcnksXG4gICAgICBjYXJTZXJ2aWNlLmNhclJlcG9zaXRvcnkuZmluZC5uYW1lXG4gICAgKS5yZXNvbHZlcyhjYXIpXG5cbiAgICBzYW5kYm94LnNweShcbiAgICAgIGNhclNlcnZpY2UsXG4gICAgICBjYXJTZXJ2aWNlLmNob29zZVJhbmRvbUNhci5uYW1lXG4gICAgKVxuXG4gICAgY29uc3QgcmVzdWx0ID0gYXdhaXQgY2FyU2VydmljZS5nZXRBdmFpbGFibGVDYXIoY2FyQ2F0ZWdvcnkpXG4gICAgY29uc3QgZXhwZWN0ZWQgPSBjYXJcblxuICAgIGV4cGVjdChjYXJTZXJ2aWNlLmNob29zZVJhbmRvbUNhci5jYWxsZWRPbmNlKS50by5iZS5va1xuICAgIGV4cGVjdChjYXJTZXJ2aWNlLmNhclJlcG9zaXRvcnkuZmluZC5jYWxsZWRXaXRoRXhhY3RseShjYXIuaWQpKS50by5iZS5va1xuICAgIGV4cGVjdChyZXN1bHQpLnRvLmJlLmRlZXAuZXF1YWwoZXhwZWN0ZWQpXG4gIH0pXG5cbiAgaXQoJ2dpdmVuIGEgY2FyQ2F0ZWdvcnksIGN1c3RvbWVyIGFuZCBudW1iZXJPZkRheXMgaXQgc2hvdWxkIGNhbGN1bGF0ZSBmaW5hbCBhbW91bnQgaW4gcmVhbCcsICgpID0+IHtcbiAgICBjb25zdCBjdXN0b21lciA9IE9iamVjdC5jcmVhdGUobW9ja3MudmFsaWRDdXN0b21lcilcbiAgICBjdXN0b21lci5hZ2UgPSA1MFxuXG4gICAgY29uc3QgY2FyQ2F0ZWdvcnkgPSBPYmplY3QuY3JlYXRlKG1vY2tzLnZhbGlkQ2FyQ2F0ZWdvcnkpXG4gICAgY2FyQ2F0ZWdvcnkucHJpY2UgPSAzNy42XG5cbiAgICBjb25zdCBudW1iZXJPZkRheXMgPSA1XG5cbiAgICAvLyBuYW8gZGVwZW5kZXIgZGUgZGFkb3MgZXh0ZXJub3MhXG4gICAgc2FuZGJveC5zdHViKFxuICAgICAgY2FyU2VydmljZSxcbiAgICAgIFwidGF4ZXNCYXNlZE9uQWdlXCJcbiAgICApLmdldCgoKSA9PiBbeyBmcm9tOiA0MCwgdG86IDUwLCB0aGVuOiAxLjMgfV0pXG5cbiAgICBjb25zdCBleHBlY3RlZCA9IGNhclNlcnZpY2UuY3VycmVuY3lGb3JtYXQuZm9ybWF0KDI0NC40MClcbiAgICBjb25zdCByZXN1bHQgPSBjYXJTZXJ2aWNlLmNhbGN1bGF0ZUZpbmFsUHJpY2UoXG4gICAgICBjdXN0b21lcixcbiAgICAgIGNhckNhdGVnb3J5LFxuICAgICAgbnVtYmVyT2ZEYXlzXG4gICAgKVxuXG4gICAgZXhwZWN0KHJlc3VsdCkudG8uYmUuZXF1YWwoZXhwZWN0ZWQpXG4gIH0pXG5cbiAgaXQoJ2dpdmVuIGEgY3VzdG9tZXIgYW5kIGEgY2FyIGNhdGVnb3J5IGl0IHNob3VsZCByZXR1cm4gYSB0cmFuc2FjdGlvbiByZWNlaXB0JywgYXN5bmMgKCkgPT4ge1xuICAgIGNvbnN0IGNhciA9IG1vY2tzLnZhbGlkQ2FyXG4gICAgY29uc3QgY2FyQ2F0ZWdvcnkgPSB7XG4gICAgICAuLi5tb2Nrcy52YWxpZENhckNhdGVnb3J5LFxuICAgICAgcHJpY2U6IDM3LjYsXG4gICAgICBjYXJJZHM6IFtjYXIuaWRdXG4gICAgfVxuXG4gICAgY29uc3QgY3VzdG9tZXIgPSBPYmplY3QuY3JlYXRlKG1vY2tzLnZhbGlkQ3VzdG9tZXIpXG4gICAgY3VzdG9tZXIuYWdlID0gMjBcblxuICAgIGNvbnN0IG51bWJlck9mRGF5cyA9IDVcbiAgICBjb25zdCBkdWVEYXRlID0gXCIxMCBkZSBub3ZlbWJybyBkZSAyMDIwXCJcblxuICAgIGNvbnN0IG5vdyA9IG5ldyBEYXRlKDIwMjAsIDEwLCA1KVxuICAgIHNhbmRib3gudXNlRmFrZVRpbWVycyhub3cuZ2V0VGltZSgpKVxuICAgIC8vIGFnZTogMjAsIHRheDogMS4xLCBjYXRlZ29yeVByaWNlOiAzNy42XG4gICAgLy8gMzcuNiAqIDEuMSA9IDQxLjM2ICogNSBkYXlzID0gMjA2LjhcbiAgICBzYW5kYm94LnN0dWIoXG4gICAgICBjYXJTZXJ2aWNlLmNhclJlcG9zaXRvcnksXG4gICAgICBjYXJTZXJ2aWNlLmNhclJlcG9zaXRvcnkuZmluZC5uYW1lLFxuICAgICkucmVzb2x2ZXMoY2FyKVxuXG4gICAgY29uc3QgZXhwZWN0ZWRBbW91bnQgPSBjYXJTZXJ2aWNlLmN1cnJlbmN5Rm9ybWF0LmZvcm1hdCgyMDYuODApXG4gICAgY29uc3QgcmVzdWx0ID0gYXdhaXQgY2FyU2VydmljZS5yZW50KFxuICAgICAgY3VzdG9tZXIsIGNhckNhdGVnb3J5LCBudW1iZXJPZkRheXNcbiAgICApXG4gICAgY29uc3QgZXhwZWN0ZWQgPSBuZXcgVHJhbnNhY3Rpb24oe1xuICAgICAgY3VzdG9tZXIsXG4gICAgICBjYXIsXG4gICAgICBkdWVEYXRlLFxuICAgICAgYW1vdW50OiBleHBlY3RlZEFtb3VudCxcbiAgICB9KVxuXG4gICAgZXhwZWN0KHJlc3VsdCkudG8uYmUuZGVlcC5lcXVhbChleHBlY3RlZClcbiAgfSlcbn0pIl19