function cov_2g0b0qsgre(){var path="/Users/guilherme/Documents/Desenvolvimento/js-experts/aula05-tdd-project-pt03/src/service/carService.js";var hash="645a6638e9b504bee3510aa0494d2a140d455741";var global=new Function("return this")();var gcv="__coverage__";var coverageData={path:"/Users/guilherme/Documents/Desenvolvimento/js-experts/aula05-tdd-project-pt03/src/service/carService.js",statementMap:{"0":{start:{line:1,column:23},end:{line:1,column:69}},"1":{start:{line:2,column:12},end:{line:2,column:40}},"2":{start:{line:3,column:20},end:{line:3,column:56}},"3":{start:{line:6,column:4},end:{line:6,column:59}},"4":{start:{line:7,column:4},end:{line:7,column:46}},"5":{start:{line:8,column:4},end:{line:11,column:6}},"6":{start:{line:15,column:23},end:{line:15,column:34}},"7":{start:{line:16,column:4},end:{line:18,column:5}},"8":{start:{line:22,column:27},end:{line:22,column:78}},"9":{start:{line:23,column:18},end:{line:23,column:52}},"10":{start:{line:24,column:4},end:{line:24,column:16}},"11":{start:{line:29,column:18},end:{line:29,column:51}},"12":{start:{line:30,column:16},end:{line:30,column:52}},"13":{start:{line:31,column:4},end:{line:31,column:14}},"14":{start:{line:35,column:20},end:{line:35,column:28}},"15":{start:{line:36,column:18},end:{line:36,column:35}},"16":{start:{line:37,column:26},end:{line:38,column:52}},"17":{start:{line:38,column:19},end:{line:38,column:51}},"18":{start:{line:40,column:24},end:{line:40,column:54}},"19":{start:{line:41,column:27},end:{line:41,column:65}},"20":{start:{line:42,column:4},end:{line:42,column:25}},"21":{start:{line:46,column:16},end:{line:46,column:55}},"22":{start:{line:47,column:23},end:{line:47,column:90}},"23":{start:{line:49,column:18},end:{line:49,column:28}},"24":{start:{line:50,column:4},end:{line:50,column:49}},"25":{start:{line:51,column:20},end:{line:51,column:70}},"26":{start:{line:52,column:20},end:{line:52,column:62}},"27":{start:{line:54,column:24},end:{line:59,column:6}},"28":{start:{line:61,column:4},end:{line:61,column:22}},"29":{start:{line:66,column:0},end:{line:66,column:27}}},fnMap:{"0":{name:"(anonymous_0)",decl:{start:{line:5,column:2},end:{line:5,column:3}},loc:{start:{line:5,column:24},end:{line:12,column:3}},line:5},"1":{name:"(anonymous_1)",decl:{start:{line:14,column:2},end:{line:14,column:3}},loc:{start:{line:14,column:35},end:{line:19,column:3}},line:14},"2":{name:"(anonymous_2)",decl:{start:{line:21,column:2},end:{line:21,column:3}},loc:{start:{line:21,column:31},end:{line:25,column:3}},line:21},"3":{name:"(anonymous_3)",decl:{start:{line:28,column:2},end:{line:28,column:3}},loc:{start:{line:28,column:37},end:{line:32,column:3}},line:28},"4":{name:"(anonymous_4)",decl:{start:{line:34,column:2},end:{line:34,column:3}},loc:{start:{line:34,column:59},end:{line:43,column:3}},line:34},"5":{name:"(anonymous_5)",decl:{start:{line:38,column:12},end:{line:38,column:13}},loc:{start:{line:38,column:19},end:{line:38,column:51}},line:38},"6":{name:"(anonymous_6)",decl:{start:{line:45,column:2},end:{line:45,column:3}},loc:{start:{line:45,column:50},end:{line:62,column:3}},line:45}},branchMap:{"0":{loc:{start:{line:38,column:19},end:{line:38,column:51}},type:"binary-expr",locations:[{start:{line:38,column:19},end:{line:38,column:34}},{start:{line:38,column:38},end:{line:38,column:51}}],line:38}},s:{"0":0,"1":0,"2":0,"3":0,"4":0,"5":0,"6":0,"7":0,"8":0,"9":0,"10":0,"11":0,"12":0,"13":0,"14":0,"15":0,"16":0,"17":0,"18":0,"19":0,"20":0,"21":0,"22":0,"23":0,"24":0,"25":0,"26":0,"27":0,"28":0,"29":0},f:{"0":0,"1":0,"2":0,"3":0,"4":0,"5":0,"6":0},b:{"0":[0,0]},_coverageSchema:"1a1c01bbd47fc00a2c39e90264f33305004495a9",hash:"645a6638e9b504bee3510aa0494d2a140d455741"};var coverage=global[gcv]||(global[gcv]={});if(!coverage[path]||coverage[path].hash!==hash){coverage[path]=coverageData;}var actualCoverage=coverage[path];{// @ts-ignore
cov_2g0b0qsgre=function(){return actualCoverage;};}return actualCoverage;}cov_2g0b0qsgre();const BaseRepository=(cov_2g0b0qsgre().s[0]++,require('./../repository/base/baseRepository'));const Tax=(cov_2g0b0qsgre().s[1]++,require('./../entities/tax'));const Transaction=(cov_2g0b0qsgre().s[2]++,require('./../entities/transaction'));class CarService{constructor({cars}){cov_2g0b0qsgre().f[0]++;cov_2g0b0qsgre().s[3]++;this.carRepository=new BaseRepository({file:cars});cov_2g0b0qsgre().s[4]++;this.taxesBasedOnAge=Tax.taxesBasedOnAge;cov_2g0b0qsgre().s[5]++;this.currencyFormat=new Intl.NumberFormat('pt-br',{style:'currency',currency:'BRL'});}getRandomPositionFromArray(list){cov_2g0b0qsgre().f[1]++;const listLength=(cov_2g0b0qsgre().s[6]++,list.length);cov_2g0b0qsgre().s[7]++;return Math.floor(Math.random()*listLength);}chooseRandomCar(carCategory){cov_2g0b0qsgre().f[2]++;const randomCarIndex=(cov_2g0b0qsgre().s[8]++,this.getRandomPositionFromArray(carCategory.carIds));const carId=(cov_2g0b0qsgre().s[9]++,carCategory.carIds[randomCarIndex]);cov_2g0b0qsgre().s[10]++;return carId;}async getAvailableCar(carCategory){cov_2g0b0qsgre().f[3]++;const carId=(cov_2g0b0qsgre().s[11]++,this.chooseRandomCar(carCategory));const car=(cov_2g0b0qsgre().s[12]++,await this.carRepository.find(carId));cov_2g0b0qsgre().s[13]++;return car;}calculateFinalPrice(customer,carCategory,numberOfDays){cov_2g0b0qsgre().f[4]++;const{age}=(cov_2g0b0qsgre().s[14]++,customer);const price=(cov_2g0b0qsgre().s[15]++,carCategory.price);const{then:tax}=(cov_2g0b0qsgre().s[16]++,this.taxesBasedOnAge.find(tax=>{cov_2g0b0qsgre().f[5]++;cov_2g0b0qsgre().s[17]++;return(cov_2g0b0qsgre().b[0][0]++,age>=tax.from)&&(cov_2g0b0qsgre().b[0][1]++,age<=tax.to);}));const fianlPrice=(cov_2g0b0qsgre().s[18]++,tax*price*numberOfDays);const formattedPrice=(cov_2g0b0qsgre().s[19]++,this.currencyFormat.format(fianlPrice));cov_2g0b0qsgre().s[20]++;return formattedPrice;}async rent(customer,carCategory,numberOfDays){cov_2g0b0qsgre().f[6]++;const car=(cov_2g0b0qsgre().s[21]++,await this.getAvailableCar(carCategory));const finalPrice=(cov_2g0b0qsgre().s[22]++,await this.calculateFinalPrice(customer,carCategory,numberOfDays));const today=(cov_2g0b0qsgre().s[23]++,new Date());cov_2g0b0qsgre().s[24]++;today.setDate(today.getDate()+numberOfDays);const options=(cov_2g0b0qsgre().s[25]++,{year:"numeric",month:"long",day:"numeric"});const dueDate=(cov_2g0b0qsgre().s[26]++,today.toLocaleDateString("pt-br",options));const transaction=(cov_2g0b0qsgre().s[27]++,new Transaction({customer,dueDate,car,amount:finalPrice}));cov_2g0b0qsgre().s[28]++;return transaction;}}cov_2g0b0qsgre().s[29]++;module.exports=CarService;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImNhclNlcnZpY2UuanMiXSwibmFtZXMiOlsiQmFzZVJlcG9zaXRvcnkiLCJyZXF1aXJlIiwiVGF4IiwiVHJhbnNhY3Rpb24iLCJDYXJTZXJ2aWNlIiwiY29uc3RydWN0b3IiLCJjYXJzIiwiY2FyUmVwb3NpdG9yeSIsImZpbGUiLCJ0YXhlc0Jhc2VkT25BZ2UiLCJjdXJyZW5jeUZvcm1hdCIsIkludGwiLCJOdW1iZXJGb3JtYXQiLCJzdHlsZSIsImN1cnJlbmN5IiwiZ2V0UmFuZG9tUG9zaXRpb25Gcm9tQXJyYXkiLCJsaXN0IiwibGlzdExlbmd0aCIsImxlbmd0aCIsIk1hdGgiLCJmbG9vciIsInJhbmRvbSIsImNob29zZVJhbmRvbUNhciIsImNhckNhdGVnb3J5IiwicmFuZG9tQ2FySW5kZXgiLCJjYXJJZHMiLCJjYXJJZCIsImdldEF2YWlsYWJsZUNhciIsImNhciIsImZpbmQiLCJjYWxjdWxhdGVGaW5hbFByaWNlIiwiY3VzdG9tZXIiLCJudW1iZXJPZkRheXMiLCJhZ2UiLCJwcmljZSIsInRoZW4iLCJ0YXgiLCJmcm9tIiwidG8iLCJmaWFubFByaWNlIiwiZm9ybWF0dGVkUHJpY2UiLCJmb3JtYXQiLCJyZW50IiwiZmluYWxQcmljZSIsInRvZGF5IiwiRGF0ZSIsInNldERhdGUiLCJnZXREYXRlIiwib3B0aW9ucyIsInllYXIiLCJtb250aCIsImRheSIsImR1ZURhdGUiLCJ0b0xvY2FsZURhdGVTdHJpbmciLCJ0cmFuc2FjdGlvbiIsImFtb3VudCIsIm1vZHVsZSIsImV4cG9ydHMiXSwibWFwcGluZ3MiOiJtd0hBZVk7MkZBZlosS0FBTUEsQ0FBQUEsY0FBYywwQkFBR0MsT0FBTyxDQUFDLHFDQUFELENBQVYsQ0FBcEIsQ0FDQSxLQUFNQyxDQUFBQSxHQUFHLDBCQUFHRCxPQUFPLENBQUMsbUJBQUQsQ0FBVixDQUFULENBQ0EsS0FBTUUsQ0FBQUEsV0FBVywwQkFBR0YsT0FBTyxDQUFDLDJCQUFELENBQVYsQ0FBakIsQ0FDQSxLQUFNRyxDQUFBQSxV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QkMsS0FBSyxDQUFFLE1BQTFCLENBQWtDQyxHQUFHLENBQUUsU0FBdkMsQ0FBSCxDQUFiLENBQ0EsS0FBTUMsQ0FBQUEsT0FBTywyQkFBR1IsS0FBSyxDQUFDUyxrQkFBTixDQUF5QixPQUF6QixDQUFrQ0wsT0FBbEMsQ0FBSCxDQUFiLENBRUEsS0FBTU0sQ0FBQUEsV0FBVywyQkFBRyxHQUFJbkQsQ0FBQUEsV0FBSixDQUFnQixDQUNsQzRCLFFBRGtDLENBRWxDcUIsT0FGa0MsQ0FHbEN4QixHQUhrQyxDQUlsQzJCLE1BQU0sQ0FBRVosVUFKMEIsQ0FBaEIsQ0FBSCxDQUFqQixDQVQ4Qyx5QkFnQjlDLE1BQU9XLENBQUFBLFdBQVAsQ0FDRCxDQTFEYyxDLHlCQThEakJFLE1BQU0sQ0FBQ0MsT0FBUCxDQUFpQnJELFVBQWpCIiwic291cmNlc0NvbnRlbnQiOlsiY29uc3QgQmFzZVJlcG9zaXRvcnkgPSByZXF1aXJlKCcuLy4uL3JlcG9zaXRvcnkvYmFzZS9iYXNlUmVwb3NpdG9yeScpXG5jb25zdCBUYXggPSByZXF1aXJlKCcuLy4uL2VudGl0aWVzL3RheCcpXG5jb25zdCBUcmFuc2FjdGlvbiA9IHJlcXVpcmUoJy4vLi4vZW50aXRpZXMvdHJhbnNhY3Rpb24nKVxuY2xhc3MgQ2FyU2VydmljZSB7XG4gIGNvbnN0cnVjdG9yKHsgY2FycyB9KSB7XG4gICAgdGhpcy5jYXJSZXBvc2l0b3J5ID0gbmV3IEJhc2VSZXBvc2l0b3J5KHsgZmlsZTogY2FycyB9KVxuICAgIHRoaXMudGF4ZXNCYXNlZE9uQWdlID0gVGF4LnRheGVzQmFzZWRPbkFnZVxuICAgIHRoaXMuY3VycmVuY3lGb3JtYXQgPSBuZXcgSW50bC5OdW1iZXJGb3JtYXQoJ3B0LWJyJywge1xuICAgICAgc3R5bGU6ICdjdXJyZW5jeScsXG4gICAgICBjdXJyZW5jeTogJ0JSTCdcbiAgICB9KVxuICB9XG5cbiAgZ2V0UmFuZG9tUG9zaXRpb25Gcm9tQXJyYXkobGlzdCkge1xuICAgIGNvbnN0IGxpc3RMZW5ndGggPSBsaXN0Lmxlbmd0aFxuICAgIHJldHVybiBNYXRoLmZsb29yKFxuICAgICAgTWF0aC5yYW5kb20oKSAqIChsaXN0TGVuZ3RoKVxuICAgIClcbiAgfVxuXG4gIGNob29zZVJhbmRvbUNhcihjYXJDYXRlZ29yeSkge1xuICAgIGNvbnN0IHJhbmRvbUNhckluZGV4ID0gdGhpcy5nZXRSYW5kb21Qb3NpdGlvbkZyb21BcnJheShjYXJDYXRlZ29yeS5jYXJJZHMpXG4gICAgY29uc3QgY2FySWQgPSBjYXJDYXRlZ29yeS5jYXJJZHNbcmFuZG9tQ2FySW5kZXhdXG4gICAgcmV0dXJuIGNhcklkXG4gIH1cblxuXG4gIGFzeW5jIGdldEF2YWlsYWJsZUNhcihjYXJDYXRlZ29yeSkge1xuICAgIGNvbnN0IGNhcklkID0gdGhpcy5jaG9vc2VSYW5kb21DYXIoY2FyQ2F0ZWdvcnkpXG4gICAgY29uc3QgY2FyID0gYXdhaXQgdGhpcy5jYXJSZXBvc2l0b3J5LmZpbmQoY2FySWQpXG4gICAgcmV0dXJuIGNhclxuICB9XG5cbiAgY2FsY3VsYXRlRmluYWxQcmljZShjdXN0b21lciwgY2FyQ2F0ZWdvcnksIG51bWJlck9mRGF5cykge1xuICAgIGNvbnN0IHsgYWdlIH0gPSBjdXN0b21lclxuICAgIGNvbnN0IHByaWNlID0gY2FyQ2F0ZWdvcnkucHJpY2VcbiAgICBjb25zdCB7IHRoZW46IHRheCB9ID0gdGhpcy50YXhlc0Jhc2VkT25BZ2VcbiAgICAgIC5maW5kKHRheCA9PiBhZ2UgPj0gdGF4LmZyb20gJiYgYWdlIDw9IHRheC50bylcblxuICAgIGNvbnN0IGZpYW5sUHJpY2UgPSAoKHRheCAqIHByaWNlKSAqIChudW1iZXJPZkRheXMpKVxuICAgIGNvbnN0IGZvcm1hdHRlZFByaWNlID0gdGhpcy5jdXJyZW5jeUZvcm1hdC5mb3JtYXQoZmlhbmxQcmljZSlcbiAgICByZXR1cm4gZm9ybWF0dGVkUHJpY2VcbiAgfVxuXG4gIGFzeW5jIHJlbnQoY3VzdG9tZXIsIGNhckNhdGVnb3J5LCBudW1iZXJPZkRheXMpIHtcbiAgICBjb25zdCBjYXIgPSBhd2FpdCB0aGlzLmdldEF2YWlsYWJsZUNhcihjYXJDYXRlZ29yeSlcbiAgICBjb25zdCBmaW5hbFByaWNlID0gYXdhaXQgdGhpcy5jYWxjdWxhdGVGaW5hbFByaWNlKGN1c3RvbWVyLCBjYXJDYXRlZ29yeSwgbnVtYmVyT2ZEYXlzKVxuXG4gICAgY29uc3QgdG9kYXkgPSBuZXcgRGF0ZSgpXG4gICAgdG9kYXkuc2V0RGF0ZSh0b2RheS5nZXREYXRlKCkgKyBudW1iZXJPZkRheXMpXG4gICAgY29uc3Qgb3B0aW9ucyA9IHsgeWVhcjogXCJudW1lcmljXCIsIG1vbnRoOiBcImxvbmdcIiwgZGF5OiBcIm51bWVyaWNcIiB9XG4gICAgY29uc3QgZHVlRGF0ZSA9IHRvZGF5LnRvTG9jYWxlRGF0ZVN0cmluZyhcInB0LWJyXCIsIG9wdGlvbnMpXG5cbiAgICBjb25zdCB0cmFuc2FjdGlvbiA9IG5ldyBUcmFuc2FjdGlvbih7XG4gICAgICBjdXN0b21lcixcbiAgICAgIGR1ZURhdGUsXG4gICAgICBjYXIsXG4gICAgICBhbW91bnQ6IGZpbmFsUHJpY2VcbiAgICB9KVxuICAgIFxuICAgIHJldHVybiB0cmFuc2FjdGlvblxuICB9XG5cbn1cblxubW9kdWxlLmV4cG9ydHMgPSBDYXJTZXJ2aWNlIl19